# 高并发与分布式系统
## 异步下单场景，如何通知用户下单成功？
## 优惠券秒杀场景中，优惠券保存在哪里？
## 秒杀优化的阻塞队列是怎么实现的？
## 对于抢票的业务，忙的时候要死，闲的时候也要死，你对于数据库的读写方式有什么考虑？
## 高并发1000w个QPS，1w库存怎么设计？用分布式锁的话怎么设计？不用分布式锁怎么设计？
## 百万用户同时抢一万张优惠券，Redis热点Key性能瓶颈如何破解？
## CAS机制解决超卖问题可能会出现什么问题，使用CAS会出现超卖吗，CAS的版本号机制
## 亿级秒杀，超卖问题+少卖问题，如何解决？
[招行面试：亿级秒杀，超卖问题+少卖问题，如何解决？](https://mp.weixin.qq.com/s/sBgnw2JhmaZH-ZAIDuwZNg?scene=1)
## 熔断和限流是什么？怎么实现
## 常用的限流或者降级的算法？
## 常用限流算法的实现？
## 用户量特别大的情况下，轮询压力很大怎么优化
## 针对高QPS下，大部分访问都失败的请求，如何设计系统，阻止这些失败的请求不让它们打到服务器上，起到提前拦截的作用
## 设计一个计数系统，比如统计一个文章的点赞量、转发量、收藏数，如何保证高并发下的数据准确性和系统健壮性
## C10K问题是什么？如何解决?即，如何让10K个连接同时在线，如何解决高并发下的连接数问题？
## 除了把 Session 存 Redis 里，还有什么解决分布式环境登录态同步问题的方法?
1. 客户端存储（Token机制）
    - 原理：将用户状态信息加密后存储在客户端（如Cookie或LocalStorage），服务端仅验证Token有效性，无需存储Session。
        - 实现方式：
            - 用户登录后，服务端生成Token（如JWT），包含用户信息和签名。
            - 客户端存储Token，并在每次请求时携带。
            - 服务端验证Token的有效性和完整性。
            - 必要时可以使用Refresh Token机制，延长Token有效期。
        - 优点：
            - 无状态：无需服务端存储压力，天然支持分布式架构。
            - 跨域支持：通过Token可以轻松实现跨域认证。
        - 缺点：
            - 安全性风险：需要配合HTTPS和HttpOnly Cookie使用，防止Token泄露。
            - 无法主动注销：Token一旦发出，无法主动失效，除非设置过期时间。
2. 反向代理会话绑定（Session粘滞）
    - 原理：使用负载均衡器（如Nginx）将同一用户的请求始终转发到同一后端服务器，保持Session一致性。
        - 实现方式：
            - 在负载均衡器上配置Session粘滞策略（如基于Cookie或IP地址）。
            - 配置Nginx的`ip_hash`或`sticky`模块，确保用户请求始终由同一服务节点处理。
        - 优点：
            - 简单易用：无需修改应用逻辑，快速实现Session共享。
            - 适用于小规模集群。
        - 缺点：
            - 扩展性差：当集群规模扩大时，可能导致负载不均衡。
            - 故障恢复困难：如果绑定的后端服务器宕机，用户会失去Session信息。
3. Session复制同步
    - ​原理：通过集群内各节点实时同步Session数据（如Tomcat内置的Session复制功能）。
        - ​实现方式：通过组播协议或HTTP请求将Session变更广播到所有节点。
        - ​优点：
            - ​强一致性：所有节点Session实时一致。
        - ​缺点：
            - ​资源消耗大：网络带宽和内存占用随节点数量指数级增长。
            - ​延迟问题：同步延迟可能导致短时间内数据不一致。
4. 单点登录（SSO）
    - 原理：通过中心认证服务器（如OAuth2.0）实现跨应用的单点登录。
        - 实现方式：
            - 用户登录后，中心认证服务器生成Token，存储用户Session信息。
            - 各应用通过Token验证用户身份，获取用户信息。
        - ​优点：
            - ​跨系统同步：适用于多独立服务共享登录态的场景。
            - ​集中管理：便于统一控制权限和登录策略。
        - ​缺点：
            - ​架构复杂：需单独部署认证中心，增加运维成本。
            - ​性能依赖：认证中心可能成为性能瓶颈。
5. 数据库存储
    - 原理：将Session信息存储在数据库中，所有服务节点共享同一Session存储。
        - 实现方式：
            - 用户登录后，将Session信息存储在数据库中（如MySQL、Redis等）。
            - 各服务节点通过数据库查询获取Session信息。
        - 优点：
            - ​持久化：Session数据持久化，避免因服务器宕机丢失。
            - ​扩展性好：适用于大规模分布式系统。
        - 缺点：
            - ​性能瓶颈：数据库读写性能可能成为瓶颈。
            - ​复杂性高：需要处理数据一致性和事务问题。
6. 框架支持
    - 原理：使用Spring Session等框架，提供分布式Session管理功能。
        - 实现方式：
            - 使用Spring Session将Session存储在Redis、MongoDB等外部存储中。
            - 各服务节点通过Spring Session API访问Session信息。
        - 优点：
            - ​易用性高：集成简单，支持多种存储方式。
            - ​社区支持：有成熟的社区和文档支持。
        - 缺点：
            - ​依赖框架：需要依赖特定框架，增加学习成本。
            - ​性能开销：可能引入额外的性能开销。

# 数据库与缓存
## redis如何解决共享session问题？为什么要解决session共享?如果session要存储很多数据，如何设计？
## Redis同步更新到数据库怎么实现
## 深度分页的解决方案
[京东面试：分库分表后，如何设计 深度翻页？](https://mp.weixin.qq.com/s/Mx3G2R88EHO0koC8-HcWDA)
[81.什么是深分页，select * from tbn limit 1000000000 这个有什么问题，如果表大或者表小分别什么问题](https://github.com/itwanger/toBeBetterJavaer/blob/master/docs/src/sidebar/sanfene/mysql.md#81%E4%BB%80%E4%B9%88%E6%98%AF%E6%B7%B1%E5%88%86%E9%A1%B5select--from-tbn-limit-1000000000-%E8%BF%99%E4%B8%AA%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%E5%A6%82%E6%9E%9C%E8%A1%A8%E5%A4%A7%E6%88%96%E8%80%85%E8%A1%A8%E5%B0%8F%E5%88%86%E5%88%AB%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98)
## 如果有两个完全独立的数据库，两张表，如何在确保原子性的前提下操作这两张表？
## 自己设计数据库中遇到的问题？
## 设计抽奖系统？MySQL的锁机制在抽奖系统中有什么作用？
## 亿级流量，如何保证Redis和MySQL数据一致性?操作失败如何设计补偿？
[美团2面：亿级流量，如何保证Redis与MySQL的一致性？操作失败 如何设计 补偿？](https://mp.weixin.qq.com/s/_VyHzICG_qZENjjnHGC0UA?scene=1)
## 高并发写，为什么不推荐关系数据？
[招行面试：高并发写，为什么不推荐关系数据？](https://mp.weixin.qq.com/s/PKsa-7eZqXDg3tpgJKCAAw?scene=1)
## 10亿级分库分表，如何丝滑扩容、如何双写灰度？
[阿里二面：10亿级分库分表，如何丝滑扩容、如何双写灰度？](https://mp.weixin.qq.com/s/Cj-v4k6kORjrfySfC1_wtA?scene=1)

# 认证与授权
## 单点登录实现
## OAuth2.0的授权流程
## 登录设计时，每次都要验证token有效性吗
## jwt介绍下，三部分存了什么？
## 怎么取出token
## 如何设计session
## 扫码登录的实现过程
[美团面试：手机扫描PC二维码登录，底层原理和完整流程是什么？](https://mp.weixin.qq.com/s/-E4Lva0gPufKHsj77H7ycQ)
## 用户的请求进来，用户的信息怎样在一个请求内传递？

# Linux系统操作
## 在Linux系统，如何把一个文件从一台服务器传输到另一台服务器
## 在文本文件里用一个关键字做一个查询，应该怎么做
## 在Linux中解压一个压缩文件应该怎么做
## Linux排查问题常用命令？
1. `top`：查看系统资源使用情况，包括 CPU、内存、进程等。
2. `ps`：查看当前运行的进程。
3. `netstat`：查看网络连接状态，或`ss`命令，相比`netstat`更快。
4. `ping`：测试网络连通性。
5. `df`：查看磁盘使用情况。
6. `du`：查看目录或文件的磁盘使用情况。
7. `free`：查看内存使用情况。
8. `iostat`：查看 CPU 和 I/O 设备的使用情况。
9. `vmstat`：查看系统的虚拟内存、进程、CPU 等信息。
10. `curl`：测试 HTTP 请求。
11. `systemctl`：查看和管理系统服务。
12. `journalctl`：查看系统日志。
## 详细说一下`top`命令的使用
1. 命令主要功能
    top 是 Linux 下实时监控系统资源占用和进程状态的经典工具，可动态显示 ​CPU、内存、磁盘 I/O、网络 等核心指标，并支持交互式操作。其核心功能包括：
    - ​实时监控系统负载：查看 CPU 使用率、内存占用、运行进程数。
    - ​进程管理：排序、筛选、终止进程。
    - ​历史记录分析：保存监控数据供后续分析。
2. 常用参数
    - `-d`：指定刷新间隔时间，单位为秒。
    - `-p`：指定要监控的进程 ID。
    - `-n`：指定刷新次数。
3. 输出字段
    - `PID`：进程 ID。
    - `USER`：进程所属用户。
    - `PR`：优先级。
    - `NI`：nice 值。
    - `VIRT`：虚拟内存使用量。
    - `RES`：常驻内存使用量。
    - `SHR`：共享内存使用量。
    - `%CPU`：CPU 使用率。
    - `%MEM`：内存使用率。
    - `TIME+`：累计 CPU 时间。
    - `COMMAND`：命令名称。

# 系统设计与架构
## 文件分块下载实现依赖哪些字段，应该由前端合并还是后端合并
## 如何设计随机数生成器
## 双层拦截器的设计和作用
## 如何设计一个高性能系统（接口）？
## 如果用户系统有拉新用户需求，且有次数限制，如何设计？

# 开发与调试
## 线上项目，没日志，没后台数据，怎么排查问题
## 项目中如何实现异常处理
## 项目中如何实现敏感数据脱敏
## 深拷贝浅拷贝是什么？如何实现深拷贝

# 问题排查

## 如果用户点击了一个按钮，一直没有反应，如何排查问题？
1. 首先定位问题发生的位置：
    - 检查浏览器控制台是否有错误提示，查看网络请求是否成功，查看请求的响应时间和响应状态，由此判断问题是前端还是后端还是网络引起的。
2. 如果是前端问题：
    - 检查按钮的事件绑定是否正确，是否有 JavaScript 错误，是否有 CSS 样式导致按钮不可点击等。
    - 检查网络请求的参数是否正确，是否有跨域问题，是否有网络延迟等。
    - 检查异步请求的回调函数是否正确执行，是否有 Promise 链的错误处理等。
3. 如果是网络问题：
    - 使用`ping` 命令检查网络连通性，查看是否有丢包或延迟。
    - 使用`curl` 或 `Postman` 等工具测试接口是否可达，查看响应时间和状态码。
    - 查看`Nginx` 或 `Apache` 等服务器的访问日志，检查请求是否到达服务器。
    - 检查防火墙或安全组设置，确保请求可以到达服务器。
    - 典型的网络问题包括 DNS 解析失败、服务器端口未开放、Nginx 配置错误等。
4. 如果是后端问题：
    - 检查后端服务日志，查看是否有异常或错误信息。
    - 检查数据库连接是否正常，是否有连接池耗尽、数据库锁等问题。
    - 检查后端代码逻辑，查看是否有死循环、阻塞等问题。
    - 检查第三方服务的调用是否正常，查看是否有超时或错误。
    - 检查服务器资源使用情况，查看 CPU、内存、磁盘等是否正常。
5. 如果问题依然无法定位：
    - 使用调试工具（如 Chrome DevTools、Postman、Fiddler 等）进行逐步调试，查看请求和响应的详细信息。
    - 如果有监控系统（如 Prometheus、Grafana 等），查看相关指标和报警信息，帮助定位问题。
    - 如果问题复杂，可以考虑使用分布式追踪工具（如 Zipkin、Jaeger 等）进行链路追踪，查看请求在各个服务之间的流转情况。

# 方案设计

## 海量日志中统计次数最多的ip
[海量数据问题的处理-六种解决思路](https://www.cnblogs.com/GarrettWale/p/14478347.html)
## 设计一个电梯调度系统
